<div class="row">
  <div class="col-12">
    <h1>Loan Calculator</h1>
    <h4 class="page_subtitle">Calculate monthly Payment</h4>
    <form [formGroup]="loanCalculatorForm">
      <div class="form-group col-6">
        <div>
          <label for="principal" class="label col-sm-6 col-form-label mt-5">Principal:</label>
          <input type="number" formControlName="principal" class="ms-5 input" required />
          <div *ngIf="
              loanCalculatorForm.controls['principal'].hasError('required') &&
              (loanCalculatorForm.controls['principal'].dirty ||
                loanCalculatorForm.controls['principal'].touched)
            " class="text-danger">
            Principal is required
          </div>
          <div *ngIf="
              loanCalculatorForm.controls['principal'].hasError('min') &&
              loanCalculatorForm.controls['principal'].dirty
            " class="text-danger">
            Value must be greater than 0
          </div>
        </div>
        <div>
          <label for="interestRate" class="label col-sm-6 col-form-label mt-5">Interest Rate (%):</label>
          <input type="number" formControlName="interestRate" class="ms-5 input" step="0.01" required />
          <div *ngIf="
              loanCalculatorForm.controls['interestRate'].hasError(
                'required'
              ) &&
              (loanCalculatorForm.controls['interestRate'].dirty ||
                loanCalculatorForm.controls['interestRate'].touched)
            " class="text-danger">
            Interest Rate is required
          </div>
          <div *ngIf="
              loanCalculatorForm.controls['interestRate'].hasError('min') &&
              loanCalculatorForm.controls['interestRate'].dirty
            " class="text-danger">
            Value must be greater than 0
          </div>
        </div>
        <div>
          <label for="loanTerm" class="label col-sm-6 col-form-label mt-5">Loan Term (years):</label>
          <input type="number" formControlName="loanTerm" class="ms-5 input" step="1" required />
          <div *ngIf="
              loanCalculatorForm.controls['loanTerm'].hasError('required') &&
              (loanCalculatorForm.controls['loanTerm'].dirty ||
                loanCalculatorForm.controls['loanTerm'].touched)
            " class="text-danger">
            Loan Term is required
          </div>
          <div *ngIf="
              loanCalculatorForm.controls['loanTerm'].hasError('min') &&
              loanCalculatorForm.controls['loanTerm'].dirty
            " class="text-danger">
            Value must be greater than 0
          </div>
        </div>
        <div>
          <label for="additionalMonthlyPayment" class="label col-sm-6 col-form-label mt-5">Additional Monthly
            Payment:</label>
          <input type="number" formControlName="additionalMonthlyPayment" class="ms-5 input" step="1" required />
        </div>
        <div class="buttons mt-5">
          <button type="reset" class="resetButton btn btn-secondary text-white" (click)="resetForm()">
            Reset
          </button>
          <button type="button" class="ms-3 calculateButton btn btn-primary" (click)="calculateMonthlyPayment()"
            [disabled]="
              loanCalculatorForm.controls['principal'].invalid ||
              loanCalculatorForm.controls['interestRate'].invalid ||
              loanCalculatorForm.controls['loanTerm'].invalid
            ">
            Calculate
          </button>
        </div>
      </div>
      <div *ngIf="errorMessage" class="alert alert-danger label col-6 mt-3">
        {{ errorMessage }}
      </div>
    </form>
    <div class="result mt-3 col-6">
      <div class="result-item">
        <label for="monthlyPayment" class="label col-sm-6 col-form-label mt-4">Monthly Payment:</label>
        <input type="text" class="input ms-3" [value]="monthlyPayment | number : '1.2-2'" readonly />
      </div>
      <div class="result-item">
        <label for="totalMonthlyPayment" class="label col-sm-6 col-form-label mt-5">Total Monthly Payment:</label>
        <input type="text" class="input ms-3" [value]="totalMonthlyPayment | number : '1.2-2'" readonly />
      </div>
    </div>
    <div *ngIf="amortizationSchedule.length > 0" class="amortization-table mt-5 col-12">
      <table class="table">
        <thead>
          <tr>
            <th>Payment Number</th>
            <th>Beginning Balance</th>
            <th>Scheduled Payment</th>
            <th>Additional Payment</th>
            <th>Total Payment</th>
            <th>Interest Payment</th>
            <th>Principal Payment</th>
            <th>Ending Balance</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let payment of amortizationSchedule; let i = index">
            <td>{{ payment.paymentNumber }}</td>
            <td>{{ payment.beginningBalance | number : "1.2-2" }}</td>
            <td>{{ payment.scheduledPayment | number : "1.2-2" }}</td>
            <td>{{ payment.additionalPayment | number : "1.2-2" }}</td>
            <td>{{ payment.totalPayment | number : "1.2-2" }}</td>
            <td>{{ payment.interestPayment | number : "1.2-2" }}</td>
            <td>{{ payment.principalPayment | number : "1.2-2" }}</td>
            <td>{{ payment.endingBalance | number : "1.2-2" }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>